"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[193],{193:(b,h,i)=>{i.r(h),i.d(h,{PcgSeApiModule:()=>M});var d=i(225),I=i(592),y=i(829);const{isArray:C}=Array;var P=i(232),T=i(251),v=i(564);function f(...t){const r=(0,v.jO)(t),e=function w(t){return 1===t.length&&C(t[0])?t[0]:t}(t);return e.length?new I.y(n=>{let o=e.map(()=>[]),u=e.map(()=>!1);n.add(()=>{o=u=null});for(let c=0;!n.closed&&c<e.length;c++)(0,y.Xf)(e[c]).subscribe((0,T.x)(n,F=>{if(o[c].push(F),o.every(p=>p.length)){const p=o.map(m=>m.shift());n.next(r?r(...p):p),o.some((m,U)=>!m.length&&u[U])&&n.complete()}},()=>{u[c]=!0,!o[c].length&&n.complete()}));return()=>{o=u=null}}):P.E}var l=i(946);let k=(()=>{class t{constructor(e){this.route=e}ngOnInit(){f([this.route.queryParamMap,this.route.data]).subscribe(([e,n])=>{const o=new URLSearchParams;e.keys.forEach(u=>{o.append(u,e.get(u))}),"show"===n.event&&"current"===n.target&&window.location.replace(`https://poketwitch.bframework.de/info/events/show_current_pokemon/?${o.toString()}`)})}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(d.gz))},t.\u0275cmp=l.Xpm({type:t,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,n){},encapsulation:2}),t})(),A=(()=>{class t{ngOnInit(){window.location.replace("https://poketwitch.bframework.de/info/events/spawn_cooldown/")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=l.Xpm({type:t,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,n){},encapsulation:2}),t})();var s=function(t){return t[t.I=1]="I",t[t.II=2]="II",t[t.III=3]="III",t[t.IV=4]="IV",t[t.V=5]="V",t[t.VI=6]="VI",t[t.VII=7]="VII",t[t.VIII=8]="VIII",t[t.IX=9]="IX",t}(s||{}),a=function(t){return t.BattleWild="wild_battle",t}(a||{});class V{constructor(r,e,n,o){this.generation=r,this.type=e,this.trackId=n,this.trackDuration=o}}const B=[{path:"info",children:[{path:"events",children:[{path:"show_current_pokemon",component:k,data:{event:"show",target:"current"}},{path:"spawn_cooldown",component:A},{path:"spawn_alert",component:(()=>{class t{get soundCloudPlayerIFrame(){return document.querySelector("iframe")}get soundCloudPlayer(){return this.soundCloudPlayerWidget||(this.soundCloudPlayerWidget=window.SC.Widget(this.soundCloudPlayerIFrame)),this.soundCloudPlayerWidget}constructor(e){this.route=e,this.debug=!1,this.pcgBaseUrl="https://poketwitch.bframework.de",this.soundCloudPlayerBaseUrl="https://w.soundcloud.com/player",this.soundCloudApiBaseUrl="https://api.soundcloud.com"}ngOnInit(){this.loadSoundCloudPlayer()}getEnumByValue(e,n){return Object.keys(e).filter(o=>"number"==typeof e[o]&&e[o]===n).map(o=>e[o])[0]}ngAfterContentInit(){f([this.route.data,this.route.queryParams]).subscribe(([e,n])=>{const o={...e,...n};this.debug="true"===o.debug,this.debug&&console.log(o),"true"!==o.player&&(this.soundCloudPlayerIFrame.style.display="none"),this.soundAlert=this.getSoundAlert(this.getSoundAlertGeneration(o.gen),this.getSoundAlertType(o.type),o.duration),this.debug&&console.log(this.soundAlert),setTimeout(()=>{this.soundCloudPlayer.load(this.getSoundCloudPlayerTrackUrl(this.soundAlert.trackId)),this.simulateTimerMainLoop()},1e3)})}getSoundAlert(e,n,o){const u=this.getSoundCloudPlayerTrack(e,n,o);return new V(e,n,u.id,u.duration)}getSoundAlertGeneration(e){switch(e.toLowerCase()){default:case"i":return s.I;case"ii":return s.II;case"iii":return s.III;case"iv":return s.IV;case"v":return s.V;case"Vi":return s.VI;case"vii":return s.VII;case"viii":return s.VIII;case"ix":return s.IX}}getSoundAlertType(e){return e.toLowerCase(),a.BattleWild}getSoundCloudPlayerTrack(e,n,o){if(e===s.I){if(n===a.BattleWild)return{id:"1235778460",duration:o||4400}}else if(e===s.IV){if(n===a.BattleWild)return{id:"631141938",duration:o||4800}}else if(e===s.V){if(n===a.BattleWild)return{id:"1235709346",duration:o||5100}}else if(e===s.IX&&n===a.BattleWild)return{id:"1380417496",duration:o||3500};return{id:"1235778460",duration:o||4400}}getSoundCloudPlayerTrackUrl(e){return`${this.soundCloudApiBaseUrl}/tracks/${this.soundAlert.trackId}`}loadSoundCloudPlayer(){const e=document.createElement("script");e.src=`${this.soundCloudPlayerBaseUrl}/api.js`,document.body.appendChild(e)}simulateTimerSoundAlert(){this.debug&&console.log("play"),setTimeout(()=>{this.soundCloudPlayer.pause()},this.soundAlert.trackDuration),this.soundCloudPlayer.seekTo(0),this.soundCloudPlayer.play()}simulateTimerMainLoop(){this.debug?this.simulateTimerCooldownWait(10):fetch(`${this.pcgBaseUrl}/info/events/last_spawn/`).then(e=>e.json()).then(e=>{this.simulateTimerCooldownWait(e.next_spawn)})}simulateTimerCooldownWait(e){e-=1,this.debug&&console.log("[simulateTimer]",e),"0"==e.toString()&&this.simulateTimerSoundAlert(),e>0?setTimeout(()=>{this.simulateTimerCooldownWait(e)},1e3):setTimeout(()=>{this.simulateTimerMainLoop()},2e3)}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(d.gz))},t.\u0275cmp=l.Xpm({type:t,selectors:[["ng-component"]],decls:1,vars:0,consts:[["width","100%","height","100","src","https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/1328551417&auto_play=true"]],template:function(e,n){1&e&&l._UZ(0,"iframe",0)},encapsulation:2}),t})(),data:{gen:"i",type:"wild_battle"}}]}]}];let S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[d.Bz.forChild(B),d.Bz]}),t})();var g=i(814);let W=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[g.ez]}),t})(),M=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[W,S,g.ez]}),t})()}}]);